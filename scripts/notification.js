RR.notification=(function(){function a(d,c){console.log("XXXXXprocess notification "+JSON.stringify(d)+" "+c);var e={};if(d!=null&&d.payload!=null&&d.payload.variant!=null){e.variant=d.payload.variant}if(d!=null&&d.payload!=null&&d.payload.type!=null){e.type=d.payload.type}RR.analytics.logEvent("notification-opened",e);if(!c&&d!=null&&d.payload!=null&&d.payload.game_id!=null&&d.payload.type!="chat"){RR.screens.board.run(d.payload.game_id)}RR.game.reloadGamesList()}function b(c){console.log("notification.handleOpenUrl("+c);var l=c.lastIndexOf("/");var m=c.indexOf("?");var e=m<0?c.substring(l+1):c.substring(l+1,m);if(e=="wtp"||e=="whatphoto"){e=""}var h="invite_id="+e+"&"+(m<0?"":c.substring(m+1));var d={},j,n=/[?&]?([^=]+)=([^&]*)/g;while(j=n.exec(h)){d[decodeURIComponent(j[1])]=decodeURIComponent(j[2])}if(d.cc==undefined){d.content_id=e;$.ajax({url:"http://trk.rumpus.com/refer/wtp/click",type:"POST",data:d})}var k=d.request_ids;if(k!=null){k=k.split(",")}var f=RR.game.getGamesList();for(var i in f){if(f[i].current_round!=null&&f[i].current_round.photo!=null&&(f[i].current_round.photo.id==e||(typeof(k)=="object"&&k.length>0&&f[i].current_round.fb_request_id&&k.indexOf(f[i].current_round.fb_request_id)>=0))){RR.screens.board.run(f[i].id);return}}if(typeof(e)=="string"&&e!=""){RR.screens.board.runPhoto(e)}}return{processNotification:a,handleOpenURL:b}})();